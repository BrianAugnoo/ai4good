<%= render "partial/back_button", page_name: "groups", page_path: groups_path(age_section_id: @age_section.id) %>

<div class="container px-2 py-4">
  <div class="bg-white shadow-sm rounded-4 p-3">
    <h5 class="text-center text-primary mb-4">créer un nouveau group</h5>
    <%= form_with model: @group, url: groups_path(age_section_id: @age_section.id), local: true do |f| %>


      <div class="mb-3">
        <%= f.label :etablished, "Etablissement", class: "form-label small fw-semibold" %>
        <%= f.text_field :etablished, class: "form-control form-control-sm", placeholder: "University Of Mauritius", required: true %>
      </div>


      <div class="mb-3">
        <%= f.label :name, "Nom", class: "form-label small fw-semibold" %>
        <%= f.text_field :name, class: "form-control form-control-sm", placeholder: "Placez le nom du group", required: true %>
      </div>


      <div class="mb-3">
        <%= f.label :theme, "Theme", class: "form-label small fw-semibold" %>
        <%= f.text_field :theme, class: "form-control form-control-sm", placeholder: "Histoire de Maurice", required: true %>
      </div>

      <div class="mb-3">
        <label for="members-input" class="form-label small fw-semibold">Membres du group</label>
        <input name="members" id="members-input" value="awesome,neat" autocomplete="off" placeholder="taper entrée pour valider le nom du participant">
      </div>

      <div class="mb-3">
        <%= f.label :photo, "Inserer le logo de l'établissement", class: "form-label small fw-semibold" %>
        <%= f.file_field :photo, direct_upload: true, accept: "image/*", id: "avatar_input", class: "form-control form-control-sm" %>
      </div>

      <div style="margin-top: 10px;">
        <img id="avatar_preview" style="max-width: 150px; border-radius: 10px;" />
      </div>

      <div class="d-grid">
        <%= f.submit "Publish", class: "btn btn-primary btn-sm " %>
      </div>

    <% end %>
  </div>
</div>

<script>
    new TomSelect("#members-input", {
      persist: false,
      createOnBlur: true,
      create: true
    });

  document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("avatar_input");
    const preview = document.getElementById("avatar_preview");

    input.addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        preview.src = e.target.result;
      };
      reader.readAsDataURL(file);
    });
  });
</script>
